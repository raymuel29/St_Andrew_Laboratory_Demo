<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthcare Admin Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: 168 85% 60%;
            --primary-foreground: 0 0% 100%;
            --secondary: 240 4% 16%;
            --secondary-foreground: 0 0% 100%;
            --accent: 142 71% 45%;
            --accent-foreground: 0 0% 100%;
            --background: 0 0% 7%;
            --foreground: 0 0% 98%;
            --card: 240 4% 10%;
            --card-foreground: 0 0% 98%;
            --border: 240 4% 16%;
            --muted: 240 4% 16%;
            --muted-foreground: 240 5% 65%;
        }
        
        body {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .card {
            background-color: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: 8px;
        }
        
        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.2s;
        }
        
        .btn-primary:hover {
            opacity: 0.9;
        }
        
        .btn-secondary {
            background-color: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
            border: 1px solid hsl(var(--border));
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .btn-secondary:hover {
            background-color: hsl(240 4% 20%);
        }
        
        .btn-danger {
            background-color: hsl(0 72% 51%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .btn-success {
            background-color: hsl(var(--accent));
            color: hsl(var(--accent-foreground));
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }
        
        .nav-item {
            padding: 12px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .nav-item:hover {
            background-color: hsl(var(--secondary));
        }
        
        .nav-item.active {
            background-color: hsl(var(--secondary));
            color: hsl(var(--primary));
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid hsl(var(--border));
            color: hsl(var(--muted-foreground));
            font-size: 14px;
            font-weight: 500;
        }
        
        .table td {
            padding: 12px;
            border-bottom: 1px solid hsl(var(--border));
        }
        
        .table tr:hover {
            background-color: hsl(240 4% 12%);
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .badge-success {
            background-color: hsl(142 71% 45% / 0.2);
            color: hsl(142 71% 60%);
        }
        
        .badge-warning {
            background-color: hsl(45 93% 47% / 0.2);
            color: hsl(45 93% 60%);
        }
        
        .badge-info {
            background-color: hsl(200 90% 50% / 0.2);
            color: hsl(200 90% 60%);
        }
        
        .badge-danger {
            background-color: hsl(0 72% 51% / 0.2);
            color: hsl(0 72% 65%);
        }
        
        input, select, textarea {
            background-color: hsl(var(--secondary));
            border: 1px solid hsl(var(--border));
            color: hsl(var(--foreground));
            padding: 8px 12px;
            border-radius: 6px;
            width: 100%;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: hsl(var(--primary));
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: hsl(var(--card));
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .stat-card {
            background: linear-gradient(135deg, hsl(var(--card)) 0%, hsl(240 4% 13%) 100%);
            border: 1px solid hsl(var(--border));
            border-radius: 8px;
            padding: 20px;
        }
        
        .hidden {
            display: none;
        }
        
    </style>
</head>
<body class="p-0 m-0">
    <!-- Header -->
    <header class="border-b" style="border-color: hsl(var(--border)); background-color: hsl(var(--card));">
        <div class="flex items-center justify-between px-6 py-4">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background-color: hsl(var(--primary));">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-semibold">St. Andrew Hospital</h1>
                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">Management System</p>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <span style="color: hsl(var(--muted-foreground));">Hospital Administrator: <span id="currentUserName">{{ user_info.full_name }}</span></span>
                <button class="btn-secondary" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <div class="flex">
        <!-- Sidebar -->
        <aside class="w-64 min-h-screen border-r p-4" style="border-color: hsl(var(--border)); background-color: hsl(var(--card));">
            <nav class="space-y-2">
                <div class="nav-item active" onclick="showSection('dashboard')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    Dashboard
                </div>
                <div class="nav-item" onclick="showSection('admin-accounts')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    Admin Accounts
                </div>
                <div class="nav-item" onclick="showSection('user-accounts')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                    </svg>
                    User Accounts
                </div>
                <div class="nav-item" onclick="showSection('employees')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                    Employees
                </div>
                <div class="nav-item" onclick="showSection('patients')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    Patients
                </div>
                <div class="nav-item" onclick="showSection('departments')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                    Departments
                </div>
                <div class="nav-item" onclick="showSection('audit-logs')">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    Audit Logs
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section">
                <h2 class="text-2xl font-semibold mb-6">Dashboard Overview</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span style="color: hsl(var(--muted-foreground));">Total Employees</span>
                            <svg class="w-5 h-5" style="color: hsl(var(--primary));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                            </svg>
                        </div>
                        <div class="text-3xl font-bold">47</div>
                        <div class="text-sm mt-1" style="color: hsl(var(--accent));">+3 this month</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span style="color: hsl(var(--muted-foreground));">Total Patients</span>
                            <svg class="w-5 h-5" style="color: hsl(var(--accent));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <div class="text-3xl font-bold">1,234</div>
                        <div class="text-sm mt-1" style="color: hsl(var(--accent));">+52 this week</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span style="color: hsl(var(--muted-foreground));">Departments</span>
                            <svg class="w-5 h-5" style="color: hsl(168 85% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                            </svg>
                        </div>
                        <div class="text-3xl font-bold">4</div>
                        <div class="text-sm mt-1" style="color: hsl(var(--muted-foreground));">All active</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span style="color: hsl(var(--muted-foreground));">Active Sessions</span>
                            <svg class="w-5 h-5" style="color: hsl(45 93% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div class="text-3xl font-bold">23</div>
                        <div class="text-sm mt-1" style="color: hsl(var(--muted-foreground));">Users online</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Department Overview</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background-color: hsl(var(--accent) / 0.2);">
                                        <svg class="w-5 h-5" style="color: hsl(var(--accent));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div class="font-medium">Nurses</div>
                                        <div class="text-sm" style="color: hsl(var(--muted-foreground));">15 Staff Members</div>
                                    </div>
                                </div>
                                <span class="badge badge-success">Active</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background-color: hsl(var(--primary) / 0.2);">
                                        <svg class="w-5 h-5" style="color: hsl(var(--primary));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div class="font-medium">Laboratory</div>
                                        <div class="text-sm" style="color: hsl(var(--muted-foreground));">8 Staff Members</div>
                                    </div>
                                </div>
                                <span class="badge badge-success">Active</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background-color: hsl(168 85% 60% / 0.2);">
                                        <svg class="w-5 h-5" style="color: hsl(168 85% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div class="font-medium">Pharmacy</div>
                                        <div class="text-sm" style="color: hsl(var(--muted-foreground));">12 Staff Members</div>
                                    </div>
                                </div>
                                <span class="badge badge-success">Active</span>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background-color: hsl(45 93% 60% / 0.2);">
                                        <svg class="w-5 h-5" style="color: hsl(45 93% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div class="font-medium">Business Office</div>
                                        <div class="text-sm" style="color: hsl(var(--muted-foreground));">12 Staff Members</div>
                                    </div>
                                </div>
                                <span class="badge badge-success">Active</span>
                            </div>
                        </div>
                    </div>

                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Recent Activity</h3>
                        <div class="space-y-3">
                            <div class="flex gap-3 p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="w-2 h-2 rounded-full mt-2" style="background-color: hsl(var(--accent));"></div>
                                <div class="flex-1">
                                    <div class="font-medium">New Employee Added</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">Sarah Johnson joined Nurses department</div>
                                    <div class="text-xs mt-1" style="color: hsl(var(--muted-foreground));">2 hours ago</div>
                                </div>
                            </div>
                            
                            <div class="flex gap-3 p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="w-2 h-2 rounded-full mt-2" style="background-color: hsl(var(--primary));"></div>
                                <div class="flex-1">
                                    <div class="font-medium">Patient Record Updated</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">Medical record #1234 modified by Dr. Smith</div>
                                    <div class="text-xs mt-1" style="color: hsl(var(--muted-foreground));">4 hours ago</div>
                                </div>
                            </div>
                            
                            <div class="flex gap-3 p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="w-2 h-2 rounded-full mt-2" style="background-color: hsl(45 93% 60%);"></div>
                                <div class="flex-1">
                                    <div class="font-medium">Role Assignment Changed</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">John Doe promoted to Senior Pharmacist</div>
                                    <div class="text-xs mt-1" style="color: hsl(var(--muted-foreground));">1 day ago</div>
                                </div>
                            </div>
                            
                            <div class="flex gap-3 p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="w-2 h-2 rounded-full mt-2" style="background-color: hsl(var(--accent));"></div>
                                <div class="flex-1">
                                    <div class="font-medium">New Patient Registered</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">Patient #5678 added to system</div>
                                    <div class="text-xs mt-1" style="color: hsl(var(--muted-foreground));">2 days ago</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

             <!-- Admin Accounts Section -->
            <section id="admin-accounts" class="content-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold">Admin Account Management</h2>
                    <button class="btn-primary" onclick="openModal('addAdminModal')">+ Add Admin Account</button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Current Admin Account</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div>
                                    <div class="font-medium">Username:</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));" id="currentAdminUsername">admin</div>
                                </div>
                                <button class="btn-secondary text-sm" onclick="editDefaultAdmin()">Edit</button>
                            </div>
                            <div class="flex items-center justify-between p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div>
                                    <div class="font-medium">Full Name:</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));" id="currentAdminName">John Doe</div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div>
                                    <div class="font-medium">Role:</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">Head of Hospital</div>
                                </div>
                            </div>
                            <div class="flex items-center justify-between p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div>
                                    <div class="font-medium">Password:</div>
                                    <div class="text-sm" style="color: hsl(var(--muted-foreground));">••••••••</div>
                                </div>
                                <button class="btn-secondary text-sm" onclick="changePassword()">Change</button>
                            </div>
                        </div>
                    </div>

                    <div class="card p-6">
                        <h3 class="text-lg font-semibold mb-4">Security Information</h3>
                        <div class="space-y-3">
                            <div class="p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-2 mb-2">
                                    <svg class="w-5 h-5" style="color: hsl(var(--primary));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                                    </svg>
                                    <span class="font-medium">Last Password Change</span>
                                </div>
                                <div class="text-sm" style="color: hsl(var(--muted-foreground));">Dec 1, 2024</div>
                            </div>
                            <div class="p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-2 mb-2">
                                    <svg class="w-5 h-5" style="color: hsl(45 93% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                    </svg>
                                    <span class="font-medium">Account Created</span>
                                </div>
                                <div class="text-sm" style="color: hsl(var(--muted-foreground));">Jan 15, 2024</div>
                            </div>
                            <div class="p-4 rounded-lg" style="background-color: hsl(var(--secondary));">
                                <div class="flex items-center gap-2 mb-2">
                                    <svg class="w-5 h-5" style="color: hsl(var(--accent));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0zm6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span class="font-medium">Total Admin Accounts</span>
                                </div>
                                <div class="text-sm" style="color: hsl(var(--muted-foreground));" id="totalAdminCount">1</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="p-6 border-b" style="border-color: hsl(var(--border));">
                        <h3 class="text-lg font-semibold">All Admin Accounts</h3>
                    </div>
                    
                    <table class="table" id="adminAccountsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Full Name</th>
                                <th>Password</th>
                                <th>Role</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminAccountsTableBody">
                            <!-- Data loaded via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Staff Accounts Section -->
            <section id="user-accounts" class="content-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold">User Account Management</h2>
                    <button class="btn-primary" onclick="openModal('addUserAccountModal')">+ Create User Account</button>
                </div>
                
                <div class="card p-6 mb-6">
                    <div class="flex gap-4 flex-wrap">
                        <input type="text" id="userAccountSearch" placeholder="Search user accounts..." class="flex-1 min-w-64" onkeyup="filterUserAccounts()">
                        <select id="userRoleFilter" onchange="filterUserAccounts()" class="w-48">
                            <option value="">All System</option>
                            <option value="Head of Nurse">Head of Nurse</option>
                            <option value="Front Desk">Front Desk</option>
                            <option value="Business Office">Business Office</option>
                            <option value="Laboratory">Laboratory</option>
                            <option value="Pharmacy">Pharmacy</option>
                            <option value="Doctor">Doctor</option>
                            <option value="Nurse">Nurse</option>
                            <option value="Radiology">Radiology</option> 
                        </select>
                    </div>
                </div>
            
                <div class="card">
                    <table class="table" id="userAccountsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Username</th>
                                <th>Full Name</th>
                                <th>Password</th>
                                <th>System Access</th>
                                <th>Created Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="userAccountsTableBody">
                            <!-- Data loaded via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Employees Section -->
            <section id="employees" class="content-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold">Employee Management</h2>
                    <button class="btn-primary" onclick="openModal('addEmployeeModal')">+ Add Employee</button>
                </div>

                <div class="card p-6 mb-6">
                    <div class="flex gap-4 flex-wrap">
                        <input type="text" id="employeeSearch" placeholder="Search employees..." class="flex-1 min-w-64" onkeyup="filterEmployees()">
                        <select id="departmentFilter" onchange="filterEmployees()" class="w-48">
                            <option value="">All Departments</option>
                            <option value="cardiology">Cardiologists</option>
                            <option value="gastroenterology">Gastroenterologists</option>
                            <option value="gynecology">Gynecology</option>
                            <option value="nephrology">Nephrologists</option>
                            <option value="nurses">Nurse</option>
                            <option value="orthopedic">Orthopedic</option>
                            <option value="opthalmology">Ophthalmologists</option>
                            <option value="obstetric">Obstetric</option>
                            <option value="pediatric">Pediatrics</option>
                            <option value="psychiatrist">Psychiatrists</option>
                            <option value="psychology">Psychologists</option>
                            <option value="pulmonology">Pulmonologists</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <table class="table" id="employeesTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Gender</th>
                                <th>Email</th>
                                <th>Contact Number</th>
                                <th>Address</th>
                                <th>Department</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employeesTableBody">
                            <!-- Data loaded via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Patients Section -->
            <section id="patients" class="content-section hidden">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-semibold">Patient Management</h2>
                    <button class="btn-primary" onclick="openModal('addPatientModal')">+ Add Patient</button>
                </div>

                <div class="card p-6 mb-6">
                    <input type="text" id="patientSearch" placeholder="Search patients by name, ID, or email..." class="w-full" onkeyup="filterPatients()">
                </div>

                <div class="card">
                    <table class="table" id="patientsTable">
                        <thead>
                            <tr>
                                <th>Patient ID</th>
                                <th>Name</th>
                                <th>Age</th>
                                <th>Contact</th>
                                <th>Last Visit</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="patientsTableBody">
                            <tr>
                                <td>#PAT1001</td>
                                <td>Robert Williams</td>
                                <td>45</td>
                                <td>robert.w@email.com</td>
                                <td>2024-12-15</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td>
                                    <div class="flex gap-2">
                                        <button class="btn-secondary text-sm" onclick="viewMedicalRecord(1001)">View Records</button>
                                        <button class="btn-secondary text-sm" onclick="editPatient(1001)">Edit</button>
                                        <button class="btn-danger text-sm" onclick="deletePatient(1001)">Delete</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>#PAT1002</td>
                                <td>Lisa Anderson</td>
                                <td>32</td>
                                <td>lisa.a@email.com</td>
                                <td>2024-12-18</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td>
                                    <div class="flex gap-2">
                                        <button class="btn-secondary text-sm" onclick="viewMedicalRecord(1002)">View Records</button>
                                        <button class="btn-secondary text-sm" onclick="editPatient(1002)">Edit</button>
                                        <button class="btn-danger text-sm" onclick="deletePatient(1002)">Delete</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>#PAT1003</td>
                                <td>James Taylor</td>
                                <td>58</td>
                                <td>james.t@email.com</td>
                                <td>2024-12-10</td>
                                <td><span class="badge badge-warning">Follow-up</span></td>
                                <td>
                                    <div class="flex gap-2">
                                        <button class="btn-secondary text-sm" onclick="viewMedicalRecord(1003)">View Records</button>
                                        <button class="btn-secondary text-sm" onclick="editPatient(1003)">Edit</button>
                                        <button class="btn-danger text-sm" onclick="deletePatient(1003)">Delete</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>#PAT1004</td>
                                <td>Maria Garcia</td>
                                <td>28</td>
                                <td>maria.g@email.com</td>
                                <td>2024-12-19</td>
                                <td><span class="badge badge-success">Active</span></td>
                                <td>
                                    <div class="flex gap-2">
                                        <button class="btn-secondary text-sm" onclick="viewMedicalRecord(1004)">View Records</button>
                                        <button class="btn-secondary text-sm" onclick="editPatient(1004)">Edit</button>
                                        <button class="btn-danger text-sm" onclick="deletePatient(1004)">Delete</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>#PAT1005</td>
                                <td>Thomas Brown</td>
                                <td>67</td>
                                <td>thomas.b@email.com</td>
                                <td>2024-12-12</td>
                                <td><span class="badge badge-danger">Critical</span></td>
                                <td>
                                    <div class="flex gap-2">
                                        <button class="btn-secondary text-sm" onclick="viewMedicalRecord(1005)">View Records</button>
                                        <button class="btn-secondary text-sm" onclick="editPatient(1005)">Edit</button>
                                        <button class="btn-danger text-sm" onclick="deletePatient(1005)">Delete</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Departments Section -->
            <section id="departments" class="content-section hidden">
                <h2 class="text-2xl font-semibold mb-6">Department Overview & Reports</h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Nurses Department -->
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background-color: hsl(var(--accent) / 0.2);">
                                    <svg class="w-6 h-6" style="color: hsl(var(--accent));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold">Nurses Department</h3>
                                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">15 Staff Members</p>
                                </div>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div class="space-y-3 mt-4">
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Total Staff:</span>
                                <span class="font-semibold">15</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">On Duty:</span>
                                <span class="font-semibold">12</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Patients Assigned:</span>
                                <span class="font-semibold">45</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Avg. Response Time:</span>
                                <span class="font-semibold">8 mins</span>
                            </div>
                        </div>
                        <button class="btn-secondary w-full mt-4" onclick="viewDepartmentReport('nurses')">View Full Report</button>
                    </div>

                    <!-- Laboratory Department -->
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background-color: hsl(var(--primary) / 0.2);">
                                    <svg class="w-6 h-6" style="color: hsl(var(--primary));" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold">Laboratory</h3>
                                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">8 Staff Members</p>
                                </div>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div class="space-y-3 mt-4">
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Total Staff:</span>
                                <span class="font-semibold">8</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">On Duty:</span>
                                <span class="font-semibold">6</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Tests Today:</span>
                                <span class="font-semibold">127</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Pending Results:</span>
                                <span class="font-semibold">23</span>
                            </div>
                        </div>
                        <button class="btn-secondary w-full mt-4" onclick="viewDepartmentReport('laboratory')">View Full Report</button>
                    </div>

                    <!-- Pharmacy Department -->
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background-color: hsl(168 85% 60% / 0.2);">
                                    <svg class="w-6 h-6" style="color: hsl(168 85% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold">Pharmacy</h3>
                                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">12 Staff Members</p>
                                </div>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div class="space-y-3 mt-4">
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Total Staff:</span>
                                <span class="font-semibold">12</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">On Duty:</span>
                                <span class="font-semibold">10</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Prescriptions Today:</span>
                                <span class="font-semibold">89</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Inventory Status:</span>
                                <span class="font-semibold text-green-400">Good</span>
                            </div>
                        </div>
                        <button class="btn-secondary w-full mt-4" onclick="viewDepartmentReport('pharmacy')">View Full Report</button>
                    </div>

                    <!-- Business Office Department -->
                    <div class="card p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <div class="w-12 h-12 rounded-lg flex items-center justify-center" style="background-color: hsl(45 93% 60% / 0.2);">
                                    <svg class="w-6 h-6" style="color: hsl(45 93% 60%);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                                    </svg>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold">Business Office</h3>
                                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">12 Staff Members</p>
                                </div>
                            </div>
                            <span class="badge badge-success">Active</span>
                        </div>
                        <div class="space-y-3 mt-4">
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Total Staff:</span>
                                <span class="font-semibold">12</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">On Duty:</span>
                                <span class="font-semibold">11</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Billing Today:</span>
                                <span class="font-semibold">$45,230</span>
                            </div>
                            <div class="flex justify-between">
                                <span style="color: hsl(var(--muted-foreground));">Pending Claims:</span>
                                <span class="font-semibold">18</span>
                            </div>
                        </div>
                        <button class="btn-secondary w-full mt-4" onclick="viewDepartmentReport('business-office')">View Full Report</button>
                    </div>
                </div>
            </section>

            <!-- Audit Logs Section -->
            <section id="audit-logs" class="content-section hidden">
                <h2 class="text-2xl font-semibold mb-6">Audit Logs</h2>

                <div class="card p-6 mb-6">
                    <div class="flex gap-4 flex-wrap">
                        <input type="text" id="logSearch" placeholder="Search logs..." class="flex-1 min-w-64" onkeyup="filterLogs()">
                        <select id="actionFilter" onchange="filterLogs()" class="w-48">
                            <option value="">All Actions</option>
                            <option value="create">Create</option>
                            <option value="update">Update</option>
                            <option value="delete">Delete</option>
                            <option value="login">Login</option>
                            <option value="logout">Logout</option>
                        </select>
                        <input type="date" id="dateFilter" onchange="filterLogs()" class="w-48">
                    </div>
                </div>

                <div class="card">
                    <table class="table" id="auditLogsTable">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Entity</th>
                                <th>Details</th>
                                <th>IP Address</th>
                            </tr>
                        </thead>
                        <tbody id="auditLogsTableBody">
                            <tr>
                                <td>2024-12-19 14:32:15</td>
                                <td>Admin (John Doe)</td>
                                <td><span class="badge badge-success">CREATE</span></td>
                                <td>Employee</td>
                                <td>Created new employee: Sarah Johnson</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr>
                                <td>2024-12-19 13:15:42</td>
                                <td>Dr. Smith</td>
                                <td><span class="badge badge-warning">UPDATE</span></td>
                                <td>Patient Record</td>
                                <td>Updated medical record #1234</td>
                                <td>192.168.1.105</td>
                            </tr>
                            <tr>
                                <td>2024-12-19 12:45:30</td>
                                <td>Admin (John Doe)</td>
                                <td><span class="badge badge-info">LOGIN</span></td>
                                <td>System</td>
                                <td>User logged into admin panel</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr>
                                <td>2024-12-19 11:22:18</td>
                                <td>Emily Rodriguez</td>
                                <td><span class="badge badge-warning">UPDATE</span></td>
                                <td>Employee</td>
                                <td>Updated role: John Doe to Senior Pharmacist</td>
                                <td>192.168.1.112</td>
                            </tr>
                            <tr>
                                <td>2024-12-19 10:15:05</td>
                                <td>Admin (John Doe)</td>
                                <td><span class="badge badge-danger">DELETE</span></td>
                                <td>Employee</td>
                                <td>Deleted employee: Mark Thompson</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr>
                                <td>2024-12-19 09:30:22</td>
                                <td>Nurse Manager</td>
                                <td><span class="badge badge-success">CREATE</span></td>
                                <td>Patient</td>
                                <td>Registered new patient #5678</td>
                                <td>192.168.1.120</td>
                            </tr>
                            <tr>
                                <td>2024-12-18 16:45:10</td>
                                <td>Lab Tech</td>
                                <td><span class="badge badge-warning">UPDATE</span></td>
                                <td>Lab Report</td>
                                <td>Completed lab test for patient #1234</td>
                                <td>192.168.1.130</td>
                            </tr>
                            <tr>
                                <td>2024-12-18 15:20:35</td>
                                <td>Admin (John Doe)</td>
                                <td><span class="badge badge-warning">UPDATE</span></td>
                                <td>Department</td>
                                <td>Modified Pharmacy department settings</td>
                                <td>192.168.1.100</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Employee Modal -->
    <div id="addEmployeeModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Add New Employee</h3>
                <button onclick="closeModal('addEmployeeModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="addEmployee(event)" class="space-y-4">
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="empName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Gender</label>
                    <select id="empGender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Email</label>
                    <input type="email" id="empEmail" required placeholder="employee@hospital.com">
                </div>
                <div>
                    <label class="block mb-2">Contact Number</label>
                    <input type="tel" id="empContactNumber" placeholder="Enter contact number">
                </div>
                <div>
                    <label class="block mb-2">Address</label>
                    <textarea id="empAddress" rows="3" placeholder="Enter address"></textarea>
                </div>
                <div>
                    <label class="block mb-2">Department</label>
                    <select id="empDepartment" required>
                        <option value="">Select Department</option>
                        <option value="Cardiologists">Cardiologists</option>
                        <option value="Gastroenterologists">Gastroenterologists</option>
                        <option value="Gynecology">Gynecology</option>
                        <option value="Nephrologists">Nephrologists</option>
                        <option value="Nurse">Nurse</option>
                        <option value="Orthopedic">Orthopedic</option>
                        <option value="Ophthalmologists">Ophthalmologists</option>
                        <option value="Obstetric">Obstetric</option>
                        <option value="Pediatrics">Pediatrics</option>
                        <option value="Psychiatrists">Psychiatrists</option>
                        <option value="Psychologists">Psychologists</option>
                        <option value="Pulmonologists">Pulmonologists</option>
                    </select>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Add Employee</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('addEmployeeModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Employee Modal -->
    <div id="editEmployeeModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Edit Employee</h3>
                <button onclick="closeModal('editEmployeeModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="updateEmployee(event)" class="space-y-4">
                <input type="hidden" id="editEmpId">
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="editEmpName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Gender</label>
                    <select id="editEmpGender" required>
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2">Email</label>
                    <input type="email" id="editEmpEmail" required placeholder="employee@hospital.com">
                </div>
                <div>
                    <label class="block mb-2">Contact Number</label>
                    <input type="tel" id="editEmpContactNumber" placeholder="Enter contact number">
                </div>
                <div>
                    <label class="block mb-2">Address</label>
                    <textarea id="editEmpAddress" rows="3" placeholder="Enter address"></textarea>
                </div>
                <div>
                    <label class="block mb-2">Department</label>
                    <select id="editEmpDepartment" required>
                        <option value="">Select Department</option>
                        <option value="Cardiologists">Cardiologists</option>
                        <option value="Gastroenterologists">Gastroenterologists</option>
                        <option value="Gynecology">Gynecology</option>
                        <option value="Nephrologists">Nephrologists</option>
                        <option value="Nurse">Nurse</option>
                        <option value="Orthopedic">Orthopedic</option>
                        <option value="Ophthalmologists">Ophthalmologists</option>
                        <option value="Obstetric">Obstetric</option>
                        <option value="Pediatrics">Pediatrics</option>
                        <option value="Psychiatrists">Psychiatrists</option>
                        <option value="Psychologists">Psychologists</option>
                        <option value="Pulmonologists">Pulmonologists</option>
                    </select>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Update Employee</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('editEmployeeModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Patient Modal -->
    <div id="addPatientModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Add New Patient</h3>
                <button onclick="closeModal('addPatientModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="addPatient(event)" class="space-y-4">
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="patName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Age</label>
                    <input type="number" id="patAge" required placeholder="Enter age">
                </div>
                <div>
                    <label class="block mb-2">Email</label>
                    <input type="email" id="patEmail" required placeholder="patient@email.com">
                </div>
                <div>
                    <label class="block mb-2">Phone</label>
                    <input type="tel" id="patPhone" required placeholder="Enter phone number">
                </div>
                <div>
                    <label class="block mb-2">Address</label>
                    <textarea id="patAddress" rows="3" required placeholder="Enter address"></textarea>
                </div>
                <div>
                    <label class="block mb-2">Blood Type</label>
                    <select id="patBloodType">
                        <option value="">Select Blood Type</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Add Patient</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('addPatientModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Medical Record Modal -->
    <div id="medicalRecordModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Medical Record</h3>
                <button onclick="closeModal('medicalRecordModal')" class="text-2xl">&times;</button>
            </div>
            <div class="space-y-4">
                <div class="card p-4">
                    <h4 class="font-semibold mb-2">Patient Information</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span style="color: hsl(var(--muted-foreground));">Patient ID:</span>
                            <span id="mrPatientId" class="font-semibold">#PAT1001</span>
                        </div>
                        <div class="flex justify-between">
                            <span style="color: hsl(var(--muted-foreground));">Name:</span>
                            <span id="mrPatientName" class="font-semibold">Robert Williams</span>
                        </div>
                        <div class="flex justify-between">
                            <span style="color: hsl(var(--muted-foreground));">Age:</span>
                            <span id="mrPatientAge" class="font-semibold">45</span>
                        </div>
                        <div class="flex justify-between">
                            <span style="color: hsl(var(--muted-foreground));">Blood Type:</span>
                            <span id="mrBloodType" class="font-semibold">A+</span>
                        </div>
                    </div>
                </div>

                <div class="card p-4">
                    <h4 class="font-semibold mb-2">Recent Visits</h4>
                    <div class="space-y-2">
                        <div class="p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                            <div class="font-medium">General Checkup</div>
                            <div class="text-sm" style="color: hsl(var(--muted-foreground));">Dr. Sarah Johnson - Dec 15, 2024</div>
                        </div>
                        <div class="p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                            <div class="font-medium">Blood Test</div>
                            <div class="text-sm" style="color: hsl(var(--muted-foreground));">Lab Department - Dec 10, 2024</div>
                        </div>
                    </div>
                </div>

                <div class="card p-4">
                    <h4 class="font-semibold mb-2">Prescriptions</h4>
                    <div class="space-y-2">
                        <div class="p-3 rounded-lg" style="background-color: hsl(var(--secondary));">
                            <div class="font-medium">Aspirin 100mg</div>
                            <div class="text-sm" style="color: hsl(var(--muted-foreground));">Once daily - 30 days</div>
                        </div>
                    </div>
                </div>

                <button class="btn-secondary w-full" onclick="closeModal('medicalRecordModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Change Password</h3>
                <button onclick="closeModal('changePasswordModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="updatePassword(event)" class="space-y-4">
                <div>
                    <label class="block mb-2">Current Password</label>
                    <input type="password" id="currentPassword" required placeholder="Enter current password">
                </div>
                <div>
                    <label class="block mb-2">New Password</label>
                    <input type="password" id="newPassword" required placeholder="Enter new password" minlength="6">
                </div>
                <div>
                    <label class="block mb-2">Confirm New Password</label>
                    <input type="password" id="confirmPassword" required placeholder="Confirm new password" minlength="6">
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Update Password</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('changePasswordModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Admin Modal -->
    <div id="editAdminModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Edit Admin Account</h3>
                <button onclick="closeModal('editAdminModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="updateDefaultAdmin(event)" class="space-y-4">
                <input type="hidden" id="editAdminId">
                <div>
                    <label class="block mb-2">Username</label>
                    <input type="text" id="editAdminUsername" required placeholder="Enter username">
                </div>
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="editAdminFullName" required placeholder="Enter full name">
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Update Account</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('editAdminModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Admin Modal -->
    <div id="addAdminModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Add New Admin Account</h3>
                <button onclick="closeModal('addAdminModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="addAdmin(event)" class="space-y-4">
                <div>
                    <label class="block mb-2">Username</label>
                    <input type="text" id="newAdminUsername" required placeholder="Enter username">
                </div>
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="newAdminFullName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Password</label>
                    <input type="password" id="newAdminPassword" required placeholder="Enter password" minlength="6">
                </div>
                <div class="p-4 rounded-lg" style="background-color: hsl(var(--secondary)); border: 1px solid hsl(var(--border));">
                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">
                        <strong>Note:</strong> This account will be created with "Head of Hospital" role and full admin privileges.
                    </p>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Create Admin Account</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('addAdminModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add User Account Modal -->
    <div id="addUserAccountModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Create User Account</h3>
                <button onclick="closeModal('addUserAccountModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="addUserAccount(event)" class="space-y-4">
                <div>
                    <label class="block mb-2">Username</label>
                    <input type="text" id="newUserUsername" required placeholder="Enter username (e.g., john.doe)">
                </div>
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="newUserFullName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Password</label>
                    <input type="password" id="newUserPassword" required placeholder="Enter password" minlength="6">
                </div>
                <div>
                    <label class="block mb-2">Role</label>
                    <select id="newUserRole" required>
                        <option value="">Select Role</option>
                        <option value="Head of Nurse">Head of Nurse</option>
                        <option value="Front Desk">Front Desk</option>
                        <option value="Business Office">Business Office</option>
                        <option value="Laboratory">Laboratory</option>
                        <option value="Pharmacy">Pharmacy</option>
                        <option value="Doctor">Doctor</option>
                        <option value="Nurse">Nurse</option>
                        <option value="Radiology">Radiology</option>
                    </select>
                </div>
                <div class="p-4 rounded-lg" style="background-color: hsl(var(--secondary)); border: 1px solid hsl(var(--border));">
                    <p class="text-sm" style="color: hsl(var(--muted-foreground));">
                        <strong>Info:</strong> This account will be used by employees to log into the system based on their assigned role.
                    </p>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Create Account</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('addUserAccountModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit User Account Modal -->
    <div id="editUserAccountModal" class="modal">
        <div class="modal-content p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold">Edit User Account</h3>
                <button onclick="closeModal('editUserAccountModal')" class="text-2xl">&times;</button>
            </div>
            <form onsubmit="updateUserAccount(event)" class="space-y-4">
                <input type="hidden" id="editUserId">
                <div>
                    <label class="block mb-2">Username</label>
                    <input type="text" id="editUserUsername" required placeholder="Enter username">
                </div>
                <div>
                    <label class="block mb-2">Full Name</label>
                    <input type="text" id="editUserFullName" required placeholder="Enter full name">
                </div>
                <div>
                    <label class="block mb-2">Role</label>
                    <select id="editUserRole" required>
                        <option value="">Select Role</option>
                        <option value="Head of Nurse">Head of Nurse</option>
                        <option value="Front Desk">Front Desk</option>
                        <option value="Business Office">Business Office</option>
                        <option value="Laboratory">Laboratory</option>
                        <option value="Pharmacy">Pharmacy</option>
                        <option value="Doctor">Doctor</option>
                        <option value="Nurse">Nurse</option>
                        <option value="Radiology">Radiology</option> 
                    </select>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="submit" class="btn-primary flex-1">Update Account</button>
                    <button type="button" class="btn-secondary flex-1" onclick="closeModal('editUserAccountModal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    
    <script>
        /* GLOBAL STATE */
        let adminAccounts = [];
        let userAccounts = [];
        let auditLogs = [];

        /* PAGE INITIALIZATION */
        document.addEventListener('DOMContentLoaded', () => {
            // Load initial data
            loadAdminAccounts();
            loadUserAccounts();
            loadAuditLogs();
            updateDashboardStats();
            loadCurrentUserInfo(); // Add this line
            
            // Setup event listeners
            setupEventListeners();
        });

        // Add this new function
        async function loadCurrentUserInfo() {
            try {
                const response = await fetch('/api/current-user');
                const data = await response.json();
                
                if (data.status === 'success') {
                    document.getElementById('currentUserName').textContent = data.full_name;
                }
            } catch (err) {
                console.error('Error loading current user info:', err);
            }
        }

        function setupEventListeners() {
            // Close modals when clicking outside
            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.classList.remove('active');
                }
            }
        }

        /* NAVIGATION */
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove('hidden');
            }
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Reload data if needed
            if (sectionId === 'admin-accounts') {
                loadAdminAccounts();
            } else if (sectionId === 'user-accounts') {
                loadUserAccounts();
            } else if (sectionId === 'employees') {
                loadEmployees();
            }else if (sectionId === 'audit-logs') {
                loadAuditLogs();
            }
        }

        /* MODAL FUNCTIONS */
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                
                // Reset form if exists
                const form = modal.querySelector('form');
                if (form) {
                    form.reset();
                }
            }
        }

        /* ADMIN ACCOUNT FUNCTIONS */
        async function loadAdminAccounts() {
            try {
                const response = await fetch('/api/admin/list');
                const data = await response.json();
                
                if (data.status === 'success') {
                    adminAccounts = data.data;
                    renderAdminAccountsTable();
                    updateAdminCount();
                }
            } catch (err) {
                console.error('Error loading admin accounts:', err);
                showAlert('error', 'Error', 'Failed to load admin accounts');
            }
        }

        function renderAdminAccountsTable() {
            const tbody = document.getElementById('adminAccountsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            adminAccounts.forEach(admin => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#ADM${String(admin.id).padStart(3, '0')}</td>
                    <td>${admin.username}</td>
                    <td>${admin.full_name}</td>
                    <td>••••••••</td>
                    <td><span class="badge badge-success">${admin.role}</span></td>
                    <td>${admin.created_date}</td>
                    <td>
                        <div class="flex gap-2">
                            <button class="btn-secondary text-sm" onclick="editAdmin(${admin.id})">Edit</button>
                            <button class="btn-danger text-sm" onclick="deleteAdmin(${admin.id})" ${admin.id === 1 ? 'disabled' : ''}>Delete</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateAdminCount() {
            const countElement = document.getElementById('totalAdminCount');
            if (countElement) {
                countElement.textContent = adminAccounts.length;
            }
        }

        function editDefaultAdmin() {
            if (adminAccounts.length > 0) {
                const defaultAdmin = adminAccounts[0];
                document.getElementById('editAdminId').value = defaultAdmin.id;
                document.getElementById('editAdminUsername').value = defaultAdmin.username;
                document.getElementById('editAdminFullName').value = defaultAdmin.full_name;
                openModal('editAdminModal');
            }
        }

        function editAdmin(id) {
            const admin = adminAccounts.find(a => a.id === id);
            if (admin) {
                document.getElementById('editAdminId').value = admin.id;
                document.getElementById('editAdminUsername').value = admin.username;
                document.getElementById('editAdminFullName').value = admin.full_name;
                openModal('editAdminModal');
            }
        }

        async function addAdmin(event) {
            event.preventDefault();
            
            const username = document.getElementById('newAdminUsername').value.trim();
            const password = document.getElementById('newAdminPassword').value.trim();
            const fullName = document.getElementById('newAdminFullName').value.trim();
            
            if (!username || !password || !fullName) {
                showAlert('error', 'Error', 'Please fill in all fields!');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password, full_name: fullName })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'Admin account created successfully!');
                    closeModal('addAdminModal');
                    loadAdminAccounts();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error creating admin:', err);
                showAlert('error', 'Error', 'Failed to create admin account');
            }
        }

        async function updateDefaultAdmin(event) {
            event.preventDefault();
            
            const id = parseInt(document.getElementById('editAdminId').value);
            const username = document.getElementById('editAdminUsername').value.trim();
            const fullName = document.getElementById('editAdminFullName').value.trim();
            
            if (!username || !fullName) {
                showAlert('error', 'Error', 'Please fill in all fields!');
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/update/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, full_name: fullName })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'Admin account updated successfully!');
                    closeModal('editAdminModal');
                    loadAdminAccounts();
                    
                    // Update current admin display
                    document.getElementById('currentAdminUsername').textContent = username;
                    document.getElementById('currentAdminName').textContent = fullName;
                    
                    // Update header if this is the logged-in admin
                    document.getElementById('currentUserName').textContent = fullName;
                    
                    // Optionally reload page to refresh all admin info
                    setTimeout(() => {
                        window.location.reload();
                    }, 1500);
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error updating admin:', err);
                showAlert('error', 'Error', 'Failed to update admin account');
            }
        }

        async function deleteAdmin(id) {
            if (id === 1) {
                showAlert('error', 'Error', 'Cannot delete the default admin account!');
                return;
            }
            
            if (!confirm('Are you sure you want to delete this admin account?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/delete/${id}`, {
                    method: 'DELETE'
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'Admin account deleted successfully!');
                    loadAdminAccounts();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error deleting admin:', err);
                showAlert('error', 'Error', 'Failed to delete admin account');
            }
        }

        function changePassword() {
            openModal('changePasswordModal');
        }

        async function updatePassword(event) {
            event.preventDefault();
            
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (newPassword !== confirmPassword) {
                showAlert('error', 'Error', 'New passwords do not match!');
                return;
            }
            
            if (newPassword.length < 6) {
                showAlert('error', 'Error', 'Password must be at least 6 characters long!');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/change-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ current_password: currentPassword, new_password: newPassword })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'Password updated successfully!');
                    closeModal('changePasswordModal');
                    event.target.reset();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error changing password:', err);
                showAlert('error', 'Error', 'Failed to change password');
            }
        }

        /* USER ACCOUNT FUNCTIONS */
        async function loadUserAccounts() {
            try {
                const response = await fetch('/api/user-account/list');
                const data = await response.json();
                
                if (data.status === 'success') {
                    userAccounts = data.data;
                    renderUserAccountsTable();
                }
            } catch (err) {
                console.error('Error loading user accounts:', err);
                showAlert('error', 'Error', 'Failed to load user accounts');
            }
        }

        function renderUserAccountsTable() {
            const tbody = document.getElementById('userAccountsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            userAccounts.forEach(user => {
                const badgeColor = user.role === 'Nurse' ? 'info' : 
                                user.role === 'Laboratory' ? 'warning' : 
                                user.role === 'Pharmacy' ? 'info' : 'success';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#USR${String(user.id).padStart(3, '0')}</td>
                    <td>${user.username}</td>
                    <td>${user.full_name}</td>
                    <td>••••••••</td>
                    <td><span class="badge badge-${badgeColor}">${user.role}</span></td>
                    <td>${user.created_date}</td>
                    <td>
                        <div class="flex gap-2">
                            <button class="btn-secondary text-sm" onclick="editUserAccount(${user.id})">Edit</button>
                            <button class="btn-secondary text-sm" onclick="resetUserPassword(${user.id})">Reset Password</button>
                            <button class="btn-danger text-sm" onclick="deleteUserAccount(${user.id})">Delete</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        async function addUserAccount(event) {
            event.preventDefault();
            
            const username = document.getElementById('newUserUsername').value.trim();
            const password = document.getElementById('newUserPassword').value.trim();
            const fullName = document.getElementById('newUserFullName').value.trim();
            const role = document.getElementById('newUserRole').value;
            
            if (!username || !password || !fullName || !role) {
                showAlert('error', 'Error', 'Please fill in all fields!');
                return;
            }
            
            try {
                const response = await fetch('/api/user-account/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password, full_name: fullName, role })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', `User account created!\nUsername: ${username}\nPassword: ${password}`);
                    closeModal('addUserAccountModal');
                    loadUserAccounts();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error creating user account:', err);
                showAlert('error', 'Error', 'Failed to create user account');
            }
        }

        function editUserAccount(id) {
            const user = userAccounts.find(u => u.id === id);
            if (user) {
                document.getElementById('editUserId').value = user.id;
                document.getElementById('editUserUsername').value = user.username;
                document.getElementById('editUserFullName').value = user.full_name;
                document.getElementById('editUserRole').value = user.role;
                openModal('editUserAccountModal');
            }
        }

        async function updateUserAccount(event) {
            event.preventDefault();
            
            const id = parseInt(document.getElementById('editUserId').value);
            const username = document.getElementById('editUserUsername').value.trim();
            const fullName = document.getElementById('editUserFullName').value.trim();
            const role = document.getElementById('editUserRole').value;
            
            if (!username || !fullName || !role) {
                showAlert('error', 'Error', 'Please fill in all fields!');
                return;
            }
            
            try {
                const response = await fetch(`/api/user-account/update/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, full_name: fullName, role })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'User account updated successfully!');
                    closeModal('editUserAccountModal');
                    loadUserAccounts();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error updating user account:', err);
                showAlert('error', 'Error', 'Failed to update user account');
            }
        }

        async function resetUserPassword(id) {
            const user = userAccounts.find(u => u.id === id);
            if (!user) return;
            
            const newPassword = prompt(`Enter new password for ${user.full_name}:`, 'newpass123');
            if (!newPassword) return;
            
            if (newPassword.length < 6) {
                showAlert('error', 'Error', 'Password must be at least 6 characters long!');
                return;
            }
            
            try {
                const response = await fetch(`/api/user-account/reset-password/${id}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ new_password: newPassword })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', `Password reset successfully!\nNew password: ${newPassword}`);
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error resetting password:', err);
                showAlert('error', 'Error', 'Failed to reset password');
            }
        }

        async function deleteUserAccount(id) {
            if (!confirm('Are you sure you want to delete this user account?')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/user-account/delete/${id}`, {
                    method: 'DELETE'
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showAlert('success', 'Success', 'User account deleted successfully!');
                    loadUserAccounts();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error deleting user account:', err);
                showAlert('error', 'Error', 'Failed to delete user account');
            }
        }

        function filterUserAccounts() {
            const searchTerm = document.getElementById('userAccountSearch').value.toLowerCase();
            const roleFilter = document.getElementById('userRoleFilter').value.toLowerCase();
            
            const rows = document.querySelectorAll('#userAccountsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matchesSearch = text.includes(searchTerm);
                const matchesRole = !roleFilter || text.includes(roleFilter);
                
                row.style.display = (matchesSearch && matchesRole) ? '' : 'none';
            });
        }

        /* AUDIT LOG FUNCTIONS */
        async function loadAuditLogs() {
            try {
                const response = await fetch('/api/audit-logs');
                const data = await response.json();
                
                if (data.status === 'success') {
                    auditLogs = data.data;
                    renderAuditLogsTable();
                }
            } catch (err) {
                console.error('Error loading audit logs:', err);
                showAlert('error', 'Error', 'Failed to load audit logs');
            }
        }

        function renderAuditLogsTable() {
            const tbody = document.getElementById('auditLogsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            auditLogs.forEach(log => {
                const badgeClass = log.action === 'CREATE' ? 'success' :
                                log.action === 'UPDATE' ? 'warning' :
                                log.action === 'DELETE' ? 'danger' : 'info';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${log.timestamp}</td>
                    <td>${log.full_name} (${log.username})</td>
                    <td><span class="badge badge-${badgeClass}">${log.action}</span></td>
                    <td>${log.entity}</td>
                    <td>${log.details}</td>
                    <td>${log.ip_address || 'N/A'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function filterLogs() {
            const searchTerm = document.getElementById('logSearch').value.toLowerCase();
            const actionFilter = document.getElementById('actionFilter').value.toLowerCase();
            const dateFilter = document.getElementById('dateFilter').value;
            
            const rows = document.querySelectorAll('#auditLogsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                const matchesSearch = text.includes(searchTerm);
                const matchesAction = !actionFilter || text.includes(actionFilter);
                const matchesDate = !dateFilter || row.cells[0].textContent.includes(dateFilter);
                
                row.style.display = (matchesSearch && matchesAction && matchesDate) ? '' : 'none';
            });
        }

        /* DASHBOARD STATS */
        async function updateDashboardStats() {
            try {
                const response = await fetch('/api/stats/dashboard');
                const data = await response.json();
                
                if (data.status === 'success') {
                    // Update stats if needed
                    console.log('Dashboard stats:', data.data);
                }
            } catch (err) {
                console.error('Error loading dashboard stats:', err);
            }
        }

        /* EMPLOYEE & PATIENT PLACEHOLDERS */
        async function loadEmployees() {
            try {
                const response = await fetch('/api/employee/list');
                const data = await response.json();

                if (data.status === 'success') {
                    renderEmployeesTable(data.data);
                }
            } catch (err) {
                console.error('Error loading employees:', err);
                showAlert('error', 'Error', 'Failed to load employees');
            }
        }

        function renderEmployeesTable(employees) {
            const tbody = document.getElementById('employeesTableBody');
            if (!tbody) return;

            tbody.innerHTML = '';

            if (employees.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align:center; padding:24px; color: hsl(var(--muted-foreground));">
                            No employees found.
                        </td>
                    </tr>`;
                return;
            }

            employees.forEach(emp => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${emp.name}</td>
                    <td>${emp.gender || '—'}</td>
                    <td>${emp.email}</td>
                    <td>${emp.contact_number || '—'}</td>
                    <td>${emp.address || '—'}</td>
                    <td>${emp.department}</td>
                    <td><span class="badge badge-success">${emp.status}</span></td>
                    <td>
                        <div class="flex gap-2">
                            <button class="btn-secondary text-sm" onclick="editEmployee(${emp.id})">Edit</button>
                            <button class="btn-danger text-sm" onclick="deleteEmployee(${emp.id})">Delete</button>
                        </div>
                    </td>`;
                tbody.appendChild(row);
            });
        }

        async function addEmployee(event) {
            event.preventDefault();

            const name          = document.getElementById('empName').value.trim();
            const gender        = document.getElementById('empGender').value;
            const email         = document.getElementById('empEmail').value.trim();
            const contactNumber = document.getElementById('empContactNumber').value.trim();
            const address       = document.getElementById('empAddress').value.trim();
            const department    = document.getElementById('empDepartment').value;

            if (!name || !gender || !email || !department) {
                showAlert('error', 'Error', 'Please fill in all required fields');
                return;
            }

            try {
                const response = await fetch('/api/employee/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        name, 
                        gender, 
                        email, 
                        contact_number: contactNumber,
                        address: address,
                        department 
                    })
                });

                const data = await response.json();

                if (data.status === 'success') {
                    showAlert('success', 'Success', data.message);
                    closeModal('addEmployeeModal');
                    loadEmployees();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error adding employee:', err);
                showAlert('error', 'Error', 'Failed to add employee');
            }
        }

        async function editEmployee(id) {
            try {
                const response = await fetch('/api/employee/list');
                const data = await response.json();

                const emp = data.data.find(e => e.id === id);
                if (!emp) {
                    showAlert('error', 'Error', 'Employee not found');
                    return;
                }

                document.getElementById('editEmpId').value            = emp.id;
                document.getElementById('editEmpName').value          = emp.name;
                document.getElementById('editEmpGender').value        = emp.gender || '';
                document.getElementById('editEmpEmail').value         = emp.email;
                document.getElementById('editEmpContactNumber').value = emp.contact_number || '';
                document.getElementById('editEmpAddress').value       = emp.address || '';
                document.getElementById('editEmpDepartment').value    = emp.department;

                openModal('editEmployeeModal');
            } catch (err) {
                console.error('Error fetching employee:', err);
                showAlert('error', 'Error', 'Failed to load employee data');
            }
        }

        async function updateEmployee(event) {
            event.preventDefault();

            const id            = document.getElementById('editEmpId').value;
            const name          = document.getElementById('editEmpName').value.trim();
            const gender        = document.getElementById('editEmpGender').value;
            const email         = document.getElementById('editEmpEmail').value.trim();
            const contactNumber = document.getElementById('editEmpContactNumber').value.trim();
            const address       = document.getElementById('editEmpAddress').value.trim();
            const department    = document.getElementById('editEmpDepartment').value;

            if (!name || !gender || !email || !department) {
                showAlert('error', 'Error', 'Please fill in all required fields');
                return;
            }

            try {
                const response = await fetch(`/api/employee/update/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        name, 
                        gender, 
                        email, 
                        contact_number: contactNumber,
                        address: address,
                        department 
                    })
                });

                const data = await response.json();

                if (data.status === 'success') {
                    showAlert('success', 'Success', data.message);
                    closeModal('editEmployeeModal');
                    loadEmployees();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error updating employee:', err);
                showAlert('error', 'Error', 'Failed to update employee');
            }
        }
        
        async function deleteEmployee(id) {
            if (!confirm('Are you sure you want to delete this employee?')) return;

            try {
                const response = await fetch(`/api/employee/delete/${id}`, {
                    method: 'DELETE'
                });

                const data = await response.json();

                if (data.status === 'success') {
                    showAlert('success', 'Success', data.message);
                    loadEmployees();
                } else {
                    showAlert('error', 'Error', data.message);
                }
            } catch (err) {
                console.error('Error deleting employee:', err);
                showAlert('error', 'Error', 'Failed to delete employee');
            }
        }

       
        async function filterEmployees() {
            const search     = document.getElementById('employeeSearch').value.trim();
            const department = document.getElementById('departmentFilter').value;

            try {
                let url = '/api/employee/list?';
                if (search)     url += `search=${encodeURIComponent(search)}&`;
                if (department) url += `department=${encodeURIComponent(department)}&`;

                const response = await fetch(url);
                const data     = await response.json();

                if (data.status === 'success') {
                    renderEmployeesTable(data.data);
                }
            } catch (err) {
                console.error('Error filtering employees:', err);
            }
        }



        function addPatient(event) {
            event.preventDefault();
            showAlert('info', 'Coming Soon', 'Patient management will be implemented');
            closeModal('addPatientModal');
        }

        function editPatient(id) {
            showAlert('info', 'Coming Soon', 'Patient editing will be implemented');
        }

        function deletePatient(id) {
            showAlert('info', 'Coming Soon', 'Patient deletion will be implemented');
        }

        function viewMedicalRecord(id) {
            showAlert('info', 'Coming Soon', 'Medical records will be implemented');
        }

        function filterPatients() {
            // Placeholder
        }

        function viewDepartmentReport(dept) {
            showAlert('info', 'Coming Soon', `${dept} department reports will be implemented`);
        }

        /* LOGOUT */
        async function logout() {
            if (!confirm('Are you sure you want to logout?')) {
                return;
            }
            
            try {
                const response = await fetch('/api/logout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' }
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    window.location.href = data.redirect;
                }
            } catch (err) {
                console.error('Logout error:', err);
                window.location.href = '/IMS';
            }
        }

        /* ALERT SYSTEM */
        function showAlert(type, title, message) {
            const alert = document.createElement('div');
            alert.className = `custom-alert ${type}`;
            alert.innerHTML = `
                <div class="alert-content">
                    <div class="alert-icon">
                        ${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}
                    </div>
                    <div class="alert-text">
                        <strong>${title}</strong>
                        <p>${message}</p>
                    </div>
                </div>
            `;
            
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                min-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => alert.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>